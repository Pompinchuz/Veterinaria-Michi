DocumentaciÃ³n Completa de Endpoints - Sistema Veterinaria

ğŸ“¡ Servicios Disponibles
ServicioPuertoBase de DatosURL BaseClientes3001MySQLhttp://localhost:3001/api/clientesMascotas3002MongoDBhttp://localhost:3002/api/mascotasProductos3003MongoDBhttp://localhost:3003/api/productosTrabajadores3004MySQLhttp://localhost:3004/api/trabajadoresCitas3005MySQLhttp://localhost:3005/api/citas

ğŸ¥ SERVICIO DE CLIENTES (Puerto 3001)
Base URL: http://localhost:3001/api/clientes
ğŸ“‹ Obtener todos los clientes
httpGET /api/clientes
Respuesta:
json{
    "success": true,
    "data": [...],
    "count": 3
}

ğŸ” Buscar cliente por DNI
httpGET /api/clientes/dni/:dni
Ejemplo:
httpGET /api/clientes/dni/12345678
Respuesta:
json{
    "success": true,
    "data": {
        "id": 1,
        "dni": "12345678",
        "nombres": "Juan Carlos",
        "apellidos": "PÃ©rez LÃ³pez",
        "telefono": "987654321",
        "email": "juan.perez@email.com",
        "direccion": "Av. Principal 123",
        "created_at": "2025-12-02T22:58:16.000Z",
        "updated_at": "2025-12-02T22:58:16.000Z"
    }
}

ğŸ” Buscar cliente por ID
httpGET /api/clientes/:id

â• Crear nuevo cliente
httpPOST /api/clientes
Content-Type: application/json
Body:
json{
    "dni": "12345678",
    "nombres": "Juan Carlos",
    "apellidos": "PÃ©rez LÃ³pez",
    "telefono": "987654321",
    "email": "juan.perez@email.com",
    "direccion": "Av. Principal 123"
}
Campos obligatorios: dni, nombres, apellidos

âœï¸ Actualizar cliente
httpPUT /api/clientes/:id
Content-Type: application/json
Body:
json{
    "nombres": "Juan Carlos",
    "apellidos": "PÃ©rez LÃ³pez",
    "telefono": "999888777",
    "email": "juan.nuevo@email.com",
    "direccion": "Nueva direcciÃ³n 456"
}

ğŸ—‘ï¸ Eliminar cliente
httpDELETE /api/clientes/:id

ğŸ¾ SERVICIO DE MASCOTAS (Puerto 3002)
Base URL: http://localhost:3002/api/mascotas
ğŸ“‹ Obtener todas las mascotas
httpGET /api/mascotas

ğŸ” Buscar mascota por ID
httpGET /api/mascotas/:id

ğŸ” Obtener mascotas por DNI del cliente
httpGET /api/mascotas/cliente/:dni
Ejemplo:
httpGET /api/mascotas/cliente/12345678
Respuesta:
json{
    "success": true,
    "cliente": {
        "dni": "12345678",
        "nombres": "Juan Carlos",
        "apellidos": "PÃ©rez LÃ³pez"
    },
    "mascotas": [...],
    "count": 2
}

â• Crear nueva mascota
httpPOST /api/mascotas
Content-Type: application/json
Body:
json{
    "nombre": "Firulais",
    "especie": "perro",
    "raza": "Labrador",
    "edad": 3,
    "peso": 25.5,
    "sexo": "macho",
    "color": "dorado",
    "clienteDni": "12345678",
    "observaciones": "Mascota muy activa y juguetona"
}
Campos obligatorios: nombre, especie, clienteDni
Valores vÃ¡lidos para especie: perro, gato, ave, conejo, hamster, otro

âœï¸ Actualizar mascota
httpPUT /api/mascotas/:id
Content-Type: application/json
Body:
json{
    "peso": 26.0,
    "observaciones": "Ha ganado peso despuÃ©s del tratamiento"
}

ğŸ—‘ï¸ Eliminar mascota (soft delete)
httpDELETE /api/mascotas/:id

ğŸ’‰ Agregar vacuna a mascota
httpPOST /api/mascotas/:id/vacunas
Content-Type: application/json
Body:
json{
    "nombre": "Rabia",
    "fecha": "2024-12-01",
    "proximaDosis": "2025-12-01",
    "lote": "RAB-2024-001",
    "veterinario": "Dr. Carlos Mendoza"
}

ğŸ“ Agregar entrada al historial mÃ©dico
httpPOST /api/mascotas/:id/historial
Content-Type: application/json
Body:
json{
    "descripcion": "RevisiÃ³n general de rutina",
    "veterinario": "Dra. Ana LÃ³pez",
    "diagnostico": "Estado de salud Ã³ptimo",
    "tratamiento": "Ninguno requerido. Continuar con alimentaciÃ³n balanceada"
}

ğŸ›’ SERVICIO DE PRODUCTOS (Puerto 3003)
Base URL: http://localhost:3003/api/productos
ğŸ“‹ Obtener todos los productos
httpGET /api/productos

ğŸ” Filtrar por categorÃ­a
httpGET /api/productos?categoria=alimento
CategorÃ­as vÃ¡lidas: alimento, juguete, medicina, accesorio, higiene, otro

ğŸ” Filtrar productos con stock bajo
httpGET /api/productos?stockBajo=true

ğŸ” Buscar producto por ID
httpGET /api/productos/:id

ğŸ” Buscar por cÃ³digo de barras
httpGET /api/productos/codigo/:codigoBarras
Ejemplo:
httpGET /api/productos/codigo/7501234567890

ğŸ” Buscar productos por nombre
httpGET /api/productos/buscar/:termino
Ejemplo:
httpGET /api/productos/buscar/pelota

ğŸ“‚ Obtener lista de categorÃ­as
httpGET /api/productos/categorias/lista

â• Crear nuevo producto
httpPOST /api/productos
Content-Type: application/json
Body:
json{
    "nombre": "Alimento Premium Perro Adulto",
    "categoria": "alimento",
    "subcategoria": "Comida seca",
    "descripcion": "Alimento balanceado para perros adultos",
    "precio": 85.50,
    "stock": 50,
    "stockMinimo": 10,
    "unidadMedida": "kilogramo",
    "marca": "Ricocan",
    "proveedor": "Distribuidora Pet SA",
    "codigoBarras": "7501234567890",
    "atributos": {
        "peso": "15kg",
        "sabor": "pollo y arroz",
        "tipoAnimal": "perro"
    }
}
Campos obligatorios: nombre, categoria, precio, stock

âœï¸ Actualizar producto
httpPUT /api/productos/:id
Content-Type: application/json
Body:
json{
    "precio": 89.90,
    "descripcion": "Alimento premium actualizado"
}

ğŸ“¦ Actualizar stock
httpPATCH /api/productos/:id/stock
Content-Type: application/json
Sumar al stock:
json{
    "cantidad": 20,
    "operacion": "sumar"
}
Restar del stock:
json{
    "cantidad": 5,
    "operacion": "restar"
}
Establecer stock directamente:
json{
    "cantidad": 100
}

ğŸ—‘ï¸ Eliminar producto (soft delete)
httpDELETE /api/productos/:id

ğŸ‘¨â€âš•ï¸ SERVICIO DE TRABAJADORES (Puerto 3004)
Base URL: http://localhost:3004/api/trabajadores
ğŸ“‹ Obtener todos los trabajadores
httpGET /api/trabajadores

ğŸ” Filtrar por cargo
httpGET /api/trabajadores?cargo=veterinario
Cargos vÃ¡lidos: veterinario, enfermera, administrativo, recepcionista

ğŸ” Buscar trabajador por DNI
httpGET /api/trabajadores/dni/:dni

ğŸ” Buscar trabajador por ID
httpGET /api/trabajadores/:id

ğŸ” Obtener trabajador con sus horarios
httpGET /api/trabajadores/:id?incluirHorarios=true

â• Crear nuevo trabajador
httpPOST /api/trabajadores
Content-Type: application/json
Body:
json{
    "dni": "88888888",
    "nombres": "Roberto Carlos",
    "apellidos": "SÃ¡nchez PÃ©rez",
    "cargo": "veterinario",
    "especialidad": "TraumatologÃ­a",
    "telefono": "987888888",
    "email": "roberto.sanchez@vetclinic.com",
    "direccion": "Av. Los Laureles 456",
    "fecha_ingreso": "2024-01-15",
    "salario": 3600.00
}
Campos obligatorios: dni, nombres, apellidos, cargo

âœï¸ Actualizar trabajador
httpPUT /api/trabajadores/:id
Content-Type: application/json
Body:
json{
    "nombres": "Roberto Carlos",
    "apellidos": "SÃ¡nchez PÃ©rez",
    "cargo": "veterinario",
    "especialidad": "TraumatologÃ­a y Ortopedia",
    "salario": 3800.00
}

ğŸ—‘ï¸ Eliminar trabajador (soft delete)
httpDELETE /api/trabajadores/:id

ğŸ• Obtener horarios de un trabajador
httpGET /api/trabajadores/:id/horarios
Respuesta:
json{
    "success": true,
    "trabajador": {
        "id": 1,
        "nombres": "Carlos Alberto",
        "apellidos": "Mendoza Ruiz",
        "cargo": "veterinario"
    },
    "horarios": [
        {
            "id": 1,
            "trabajador_id": 1,
            "dia_semana": "lunes",
            "hora_inicio": "09:00:00",
            "hora_fin": "18:00:00",
            "activo": true
        }
    ],
    "count": 5
}

â• Agregar horario a trabajador
httpPOST /api/trabajadores/:id/horarios
Content-Type: application/json
Body:
json{
    "dia_semana": "lunes",
    "hora_inicio": "08:00:00",
    "hora_fin": "16:00:00"
}
DÃ­as vÃ¡lidos: lunes, martes, miercoles, jueves, viernes, sabado, domingo

ğŸ—‘ï¸ Eliminar horario
httpDELETE /api/trabajadores/:id/horarios/:horarioId

ğŸ“… SERVICIO DE CITAS (Puerto 3005)
Base URL: http://localhost:3005/api/citas
ğŸ“‹ Obtener todas las citas
httpGET /api/citas

ğŸ” Filtrar por estado
httpGET /api/citas?estado=pendiente
Estados vÃ¡lidos: pendiente, confirmada, en_curso, completada, cancelada

ğŸ” Filtrar por fecha
httpGET /api/citas?fecha=2024-12-05

ğŸ” Filtrar por cliente
httpGET /api/citas?clienteDni=12345678

ğŸ” Filtrar por mascota
httpGET /api/citas?mascotaId=692fa90a8ebd11706aed581a

ğŸ” Filtrar por veterinario
httpGET /api/citas?veterinarioId=1

ğŸ” Obtener cita por ID
httpGET /api/citas/:id

ğŸ” Obtener cita con detalles completos
httpGET /api/citas/:id?incluirDetalles=true
Respuesta incluye: datos del cliente, mascota y veterinario desde sus respectivos servicios.

â• Crear nueva cita
httpPOST /api/citas
Content-Type: application/json
Body:
json{
    "cliente_dni": "12345678",
    "mascota_id": "692fa90a8ebd11706aed581a",
    "veterinario_id": 2,
    "fecha": "2024-12-07",
    "hora": "16:00:00",
    "motivo": "RevisiÃ³n post-vacunaciÃ³n y chequeo general",
    "observaciones": "El dueÃ±o reporta que el perro ha estado mÃ¡s activo"
}
Campos obligatorios: cliente_dni, mascota_id, veterinario_id, fecha, hora, motivo
Validaciones automÃ¡ticas:

âœ… Verifica que el cliente existe
âœ… Verifica que la mascota existe
âœ… Verifica que la mascota pertenece al cliente
âœ… Verifica que el veterinario existe y es veterinario
âœ… Verifica disponibilidad del veterinario


âœï¸ Actualizar cita
httpPUT /api/citas/:id
Content-Type: application/json
Body:
json{
    "diagnostico": "Mascota en perfecto estado de salud",
    "tratamiento": "Continuar con alimentaciÃ³n balanceada",
    "costo": 150.00,
    "observaciones": "PrÃ³ximo control en 6 meses"
}

ğŸ”„ Cambiar estado de cita
httpPATCH /api/citas/:id/estado
Content-Type: application/json
Body:
json{
    "estado": "confirmada"
}

ğŸ—‘ï¸ Cancelar cita
httpDELETE /api/citas/:id
Marca la cita como cancelada (soft delete).

ğŸ“Š Obtener estadÃ­sticas
httpGET /api/citas/estadisticas/resumen
Respuesta:
json{
    "success": true,
    "data": {
        "total": 10,
        "pendientes": 3,
        "confirmadas": 4,
        "en_curso": 1,
        "completadas": 1,
        "canceladas": 1,
        "hoy": 2
    }
}

ğŸ” CÃ³digos de Estado HTTP
CÃ³digoSignificadoCuÃ¡ndo se usa200OKOperaciÃ³n exitosa (GET, PUT, PATCH)201CreatedRecurso creado exitosamente (POST)400Bad RequestDatos invÃ¡lidos o faltantes404Not FoundRecurso no encontrado409ConflictConflicto (DNI duplicado, horario ocupado)500Internal Server ErrorError del servidor

ğŸ“ Estructura de Respuestas
Respuesta Exitosa
json{
    "success": true,
    "data": {...},
    "message": "OperaciÃ³n exitosa"
}
Respuesta de Error
json{
    "success": false,
    "message": "DescripciÃ³n del error",
    "error": "Detalle tÃ©cnico del error"
}
```

---

# ğŸ” Sobre tu Pregunta: Â¿JWT primero o Frontend primero?

## Mi RecomendaciÃ³n: **SÃ, JWT y Seguridad ANTES del Frontend**

### Â¿Por quÃ©?

#### âœ… **Ventajas de hacer JWT primero:**

1. **Evitas rehacer cÃ³digo del frontend**
   - Si haces frontend primero sin autenticaciÃ³n, luego tendrÃ¡s que modificar TODAS las llamadas API para incluir tokens
   - Es mÃ¡s trabajo rehacerlo que hacerlo bien desde el inicio

2. **Defines roles desde el principio**
   - Sabes quÃ© endpoints son pÃºblicos y cuÃ¡les privados
   - Frontend se diseÃ±a ya con permisos en mente

3. **Mejores prÃ¡cticas profesionales**
   - NingÃºn sistema profesional deberÃ­a estar sin autenticaciÃ³n
   - Es mÃ¡s seguro desde el dÃ­a 1

4. **Facilita el desarrollo del frontend**
   - Ya tendrÃ¡s endpoints de login/register listos
   - El frontend solo consume APIs ya seguras

5. **Variables de entorno ya configuradas**
   - JWT_SECRET y otras variables sensibles ya estarÃ¡n protegidas

---

### ğŸ“‹ Orden Recomendado:
```
1. âœ… Backend con microservicios (YA LO TIENES)
2. ğŸ” AutenticaciÃ³n JWT + Roles
3. ğŸ” Proteger endpoints segÃºn roles
4. ğŸ” Variables de entorno seguras
5. ğŸ–¥ï¸ Frontend con login/autenticaciÃ³n
6. ğŸ–¥ï¸ Frontend completo por roles
7. â˜ï¸ Deploy



